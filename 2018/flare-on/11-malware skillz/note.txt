xor1(0x410344 ,0,19,'\x55')
LAUNCHASSIST_MUTEX
xor1(0x410360 ,0,17,'\x57')
launchassist.exe
xor1(0x410398 ,0,0x2e,'\x43')
SOFTWARE\Microsoft\Windows\CurrentVersion\Run
xor1(0x41037c ,0,0x17,'\x25')
LaunchAssist2018

LoadLibraryA VirtualAlloc Sleep lstrlenA ExitProcess dnsapi

tshark -r E:\CTF\flare-on\2018\11\pcap.pcap -Y "dns" -w E:\CTF\flare-on\2018\11\pcap1.pcap

0x40a930

feye2018 tcp cli

#define NtTerminateProcess(ProcessHandle,ExitStatus) NtCall(0x29,0x0,ProcessHandle,ExitStatus)
#define NtUserSendInput(nInputs,pInput,cbSize) NtCall(0x1082,0x0,nInputs,pInput,cbSize)
#define NtDeleteFile(ObjectAttributes) NtCall(0x0B2,0x0,ObjectAttributes)
#define NtReadVirtualMemory(ProcessHandle,BaseAddress,Buffer,NumberOfBytesToRead,NumberOfBytesRead) NtCall(0x3C,0x0,ProcessHandle,BaseAddress,Buffer,NumberOfBytesToRead,NumberOfBytesRead)
#define NtWriteVirtualMemory(ProcessHandle,BaseAddress,Buffer,NumberOfBytesToWrite,NumberOfBytesWritten) NtCall(0x37,0x0,ProcessHandle,BaseAddress,Buffer,NumberOfBytesToWrite,NumberOfBytesWritten)
#define NtOpenProcess(ProcessHandle,DesiredAccess,ObjectAttributes,ClientId) NtCall(0x23,0x0,ProcessHandle,DesiredAccess,ObjectAttributes,ClientId)
#define NtClose(Handle) NtCall(0x0C,0x0,Handle)
#define NtWaitForSingleObject(ObjectHandle,Alertable,TimeOut) NtCall(0x1,0x0D,ObjectHandle,Alertable,TimeOut)
#define NtDelayExecution(Alertable,DelayInterval) NtCall(0x31,0x6,Alertable,DelayInterval)
#define NtProtectVirtualMemory(ProcessHandle,BaseAddress,NumberOfBytesToProtect,NewAccessProtection,OldAccessProtection) NtCall(0x4D,0x0,ProcessHandle,BaseAddress,NumberOfBytesToProtect,NewAccessProtection,OldAccessProtection)
#define NtAllocateVirtualMemory(ProcessHandle,BaseAddress,ZeroBits,RegionSize,AllocationType,ProtectionType) NtCall(0x15,0x0,ProcessHandle,BaseAddress,ZeroBits,RegionSize,AllocationType,ProtectionType)
#define NtFreeVirtualMemory(ProcessHandle,BaseAddress,RegionSize,FreeType) NtCall(0x1B,0x0,ProcessHandle,BaseAddress,RegionSize,FreeType)
 
c partition serial num + ID (6bytes)  sha256
BCE83B544944

0018FD18   80BE7D0B  
0018FD1C   1F44B8E7  
0018FD20   E85C05F3  
0018FD24   CB7B75D0  
0018FD28   7F4182F4  
0018FD2C   AC1A620D  
0018FD30   49051187  
0018FD34   5D122210  
0018FD38   74E4A2A9  
0018FD3C   BAE68FEB  
0018FD40   00B24196  
0018FD44   63A8E830 
 
0018FD48   2D0BC61C  
0018FD4C   38EA0507  
0018FD50   30E1685E  
0018FD54   3D6D9181  
0018FD58   D2F439E3 
0018FD5C   6BBD6DB5 
0018FD60   8328F652  
0018FD64   A46BC420  
0018FD68   7F4D5B32  
0018FD6C   77B7861C 
0018FD70   5B54199C  
0018FD74   4D524D20  

0018FD18  0B 7D BE 80 E7 B8 44 1F F3 05 5C E8 D0 75 7B CB  }¾€ç¸D?\èÐu{?
0018FD28  F4 82 41 7F 0D 62 1A AC 87 11 05 49 10 22 12 5D  ô‚A.b¬‡I"]
0018FD38  A9 A2 E4 74 EB 8F E6 BA 96 41 B2 00 30 E8 A8 63  ©¢ätëæº–A?0è¨c
0018FD48  1C C6 0B 2D 07 05 EA 38 5E 68 E1 30 81 91 6D 3D  ?-?^h?‘m=
0018FD58  E3 39 F4 D2 B5 6D BD 6B 52 F6 28 83 20 C4 6B A4  ?ôÒµm½kR??Äk?
0018FD68  32 5B 4D 7F 1C 86 B7 77 9C 19 54 5B 20 4D 52 4D  2[M†·w?T[ MRM
0018FD78  E8 FD 18 00 D2 FF FF FF D1 FF FF FF D0 FF FF FF  èý.?ÿÿ?ÿÿ?ÿÿ
0018FD88  C8 FD 18 00 AE 2A 40 00 00 00 00 00 E8 FD 18 00  Èý.?@.....èý.
0018FD98  00 00 00 00 10 00 00 00 00 00 00 00 C8 91 56 00  ...........È‘V.
0018FDA8  D9 6F 40 00 39 67 57 02 00 00 00 00 E8 FD 18 00  Ùo@.9gW....èý.
0018FDB8  02 00 24 E3 00 00 00 00 00 00 00 00 00 00 00 00  .$?...........
0018FDC8  F4 FE 18 00 56 2A 40 00 00 00 00 00 00 00 00 00  ôþ.V*@.........
0018FDD8  E8 FD 18 00 4C 38 40 00 0A 00 00 00 86 1D 0A 77  èý.L8@.....?.w
0018FDE8  DC E9 42 00 BD 11 1F 07 4A 17 04 8D 07 C7 17 72  ÜéB.?J??r
0018FDF8  FB 4E BC 5C BD 11 1F 07 12 A5 0D 6D 7F 4D 87 60  ûN¼\??mM‡`
0018FE08  9A 4C D3 53 31 53 03 A1 5D A3 FB 67 A0 F2 4C F1  šLÓS1S¡]£ûg òL?
0018FE18  BA 0F 50 84                                      ?P„p9


00560C90                          BD 11 1F 07 4A 17 04 8D          J?
00560CA0  07 C7 17 72 FB 4E BC 5C 93 74 55 08 D9 63 51 85  ?rûN¼\“tUÙcQ?
00560CB0  DE A4 46 F7 25 EA FA AB 16 59 37 37 CF 3A 66 B2  Þ¤F?êú?Y77?f?
00560CC0  11 9E 20 45 34 74 DA EE 80 0E 1F 2F 4F 34 79 9D  ?E4tÚî€/O4y?
00560CD0  5E AA 59 D8 6A DE 83 36 95 E2 1A 2D DA D6 63 B0  ^ªYØjÞƒ6•â-ÚÖc?
00560CE0  84 7C 3A 68 EE A2 B9 5E BF B4 42 05 65 62 21 B5  „|:hî¢¹^¿´Beb!?
00560CF0  E1 1E 1B DD 0F BC A2 83 FA 8E AE 73 9F EC 8F C6  ??¼¢ƒúŽ®sŸìÆ
00560D00  7E F2 94 1B 71 4E 36 98 95 8B E8 D0 0A 67 67 16  ~ò”qN6˜•‹è?gg
00560D10  74 95 F3 0D 05 DB C5 95 AC 2D C2 BB A6 4A A5 AD  t•ó.ÛÅ•¬-Â»¦J¥­
00560D20  D2 DF 56 A0 D7 04 93 35 45 F1 54 B5 E3 BB F1 18  ÒßV ×?EñTµã»ñ
00560D30  31 64 A7 B8 E6 60 34 8D A3 E9 09 3B 40 52 F8 23  1d§¸æ`4£?;@R?
00560D40  71 36 5F 9B 97 56 6B 16                          q6_›—Vk.


0018FD18  E7 66 E6 5A E8 50 9D 68 33 D7 3A 37 D1 EC 4A D8  çfæZèPh3?7ÑìJ?
0018FD28  18 99 19 A5 40 2F 80 15 31 E9 36 D1 32 E5 DF 42  ?¥@/€1??åßB
0018FD38  F2 2F 99 C8 DB 9F FE 67 3A 03 52 C5 8D 79 99 C4  ?™ÈÛŸþg:RÅy™Ä
0018FD48  0B 7D BE 80 E7 B8 44 1F F3 05 5C E8 D0 75 7B CB  }¾€ç¸D?\èÐu{?
0018FD58  F4 82 41 7F 0D 62 1A AC 87 11 05 49 10 22 12 5D  ô‚A.b¬‡I"]
0018FD68  A9 A2 E4 74 EB 8F E6 BA 96 41 B2 00 30 E8 A8 63  ©¢ätëæº–A?0è¨c
0018FD78  E8 FD 18 00 D2 FF FF FF D1 FF FF FF D0 FF FF FF  èý.?ÿÿ?ÿÿ?ÿÿ
0018FD88  C8 FD 18 00 AE 2A 40 00 00 00 00 00 E8 FD 18 00  Èý.?@.....èý.
0018FD98  00 00 00 00 10 00 00 00 00 00 00 00 C8 91 5E 00  ...........È‘^.
0018FDA8  D9 6F 40 00 3E A2 37 5E 00 00 00 00 E8 FD 18 00  Ùo@.>?^....èý.
0018FDB8  02 00 24 E3 00 00 00 00 00 00 00 00 00 00 00 00  .$?...........
0018FDC8  F4 FE 18 00 56 2A 40 00 00 00 00 00 00 00 00 00  ôþ.V*@.........
0018FDD8  E8 FD 18 00 4C 38 40 00 0A 00 00 00 86 1D 0A 77  èý.L8@.....?.w
0018FDE8  DC E9 42 00 46 B1 F2 70 A5 42 73 DD 6A 78 CC 75  ÜéB.F±òp¥BsÝjxÌu
0018FDF8  AB 33 9B B9 46 B1 F2 70 E7 E7 30 13 1C 52 99 32  ?›¹F±òpçç0R?
0018FE08  88 6D 67 B5 F1 27 D7 16 9A BA B2 77 06 E8 4A 6F  ˆmgµñ'?šº²wèJo
0018FE18  17 3B 9B 0D                                      ;?p


62421C37A8B11C501D47EEEC0F5F05B2
46B9E23C59BE3E7F89729F47DEA3F32B

>>> d1=0xe766e65ae8509d6833d73a37d1ec4ad8189919a5402f801531e936d132e5df42f22f99c8db9ffe673a0352c58d7999c4
>>> d1=0x5fa52940576544d44d01fa2a37f49fc4a05ad6bfe0dfb9db93f389ea2de1e0e6a3f991fbe1e3b7a5541f21a27a59bf0d
>>> d2=0x5fa52940576544d44d01fa2a37f49fc4a05ad6bfe0dfb9db93f389ea2de1e0e6a3f991fbe1e3b7a5541f21a27a59bf0d
>>> d1=0xe766e65ae8509d6833d73a37d1ec4ad8189919a5402f801531e936d132e5df42f22f99c8db9ffe673a0352c58d7999c4
>>> hex(d1^d2)
'0xb8c3cf1abf35d9bc7ed6c01de618d51cb8c3cf1aa0f039cea21abf3b1f043fa451d608333a7c49c26e1c7367f72026c9L'
>>> d3 = 0xb8c3cf1abf35d9bc7ed6c01de618d51c
>>> d4 = 0xaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
>>> hex(d3^d4)
'0x126965b0159f7316d47c6ab74cb27fb6L


5400008f
86086ced59e2d00e3aac0be40f16a616aacd7b014b98767169303dd0bf668fe3
70a9f8c07d28
e2d1e4c07d28622d8c7eb6e052099861
a2eecde68e6eecd310a9a649ec2c1d770e00606d76bb4ac3bf49

01031820810000000800000001000000000000000000000070000000

789C7B591E6BCAC82CA1D0C8C0C0C001C48C0C080000447102B9



data:
  size 3bytes
  op1  1bytes
  32byts hash
  data1

data1:
  9278+size 6bytes  after xor with follow 6 bytes
  data2
  
data2:
  iv 16bytes
  realdata

really_long_password_to_prevent_cracking

recover_these_messages_lost_in_the_colorful_bits@flare-on.com